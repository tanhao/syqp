{"version":3,"sources":["AudioManager.js"],"names":["cc","Class","extends","Component","properties","bgmVolume","sfxVolume","bgmAudioID","sfxAudioID","_pauseBgm","onLoad","init","bgm","sys","localStorage","getItem","parseFloat","setItem","sfx","game","on","EVENT_HIDE","audioEngine","pauseAll","EVENT_SHOW","resumeAll","getUrl","url","raw","playBGM","audioUrl","stop","play","playSFX","setSFXVolume","v","setBGMVolume","resume","pause","setVolume"],"mappings":"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","file":"AudioManager.js","sourceRoot":"..\\..\\..\\..\\assets\\scripts","sourcesContent":["cc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        bgmVolume:0.5,\r\n        sfxVolume:0.5,\r\n        bgmAudioID:-1,\r\n        sfxAudioID:-1,\r\n        _pauseBgm:true,\r\n    },\r\n\r\n    onLoad: function () {\r\n    },\r\n\r\n\r\n\r\n    // update: function (dt) {\r\n\r\n    // },\r\n\r\n\r\n    init : function(){\r\n        var bgm = cc.sys.localStorage.getItem(\"bgmVolume\");\r\n        if(bgm){\r\n            this.bgmVolume = parseFloat(bgm);    \r\n        }else{\r\n            cc.sys.localStorage.setItem(\"bgmVolume\", this.bgmVolume);\r\n        }\r\n        \r\n        var sfx = cc.sys.localStorage.getItem(\"sfxVolume\");\r\n        if(sfx){\r\n            this.sfxVolume = parseFloat(sfx);    \r\n        }else{\r\n            cc.sys.localStorage.setItem(\"sfxVolume\", this.sfxVolume);\r\n        }\r\n\r\n        cc.game.on(cc.game.EVENT_HIDE, function () {\r\n            //console.log(\"cc.audioEngine.pauseAll\");\r\n            cc.audioEngine.pauseAll();\r\n        });\r\n        cc.game.on(cc.game.EVENT_SHOW, function () {\r\n            //console.log(\"cc.audioEngine.resumeAll\");\r\n            cc.audioEngine.resumeAll();\r\n        });\r\n    },\r\n\r\n    getUrl:function(url){\r\n        return cc.url.raw(\"resources/sounds/\" + url);\r\n    },\r\n\r\n    playBGM(url){\r\n        var audioUrl = this.getUrl(url);\r\n        if(this.bgmAudioID >= 0){\r\n            cc.audioEngine.stop(this.bgmAudioID);\r\n        }\r\n        this._pauseBgm=true;\r\n        this.bgmAudioID = cc.audioEngine.play(audioUrl,true,this.bgmVolume);\r\n    },\r\n\r\n    playSFX(url){\r\n        var audioUrl = this.getUrl(url);\r\n        /*\r\n        if(this.sfxAudioID>=0){\r\n            cc.audioEngine.stop(this.sfxAudioID);\r\n        }\r\n        */\r\n        if(this.sfxVolume > 0){\r\n            this.sfxAudioID = cc.audioEngine.play(audioUrl,false,this.sfxVolume);    \r\n        }\r\n    },\r\n\r\n    setSFXVolume:function(v){\r\n        if(this.sfxVolume != v){\r\n            cc.sys.localStorage.setItem(\"sfxVolume\",v);\r\n            this.sfxVolume = v;\r\n        }\r\n    },\r\n\r\n    setBGMVolume:function(v){\r\n     \r\n        if(this.bgmAudioID >= 0){\r\n            if(this._pauseBgm && v > 0){\r\n                this._pauseBgm=false;\r\n                cc.audioEngine.resume(this.bgmAudioID);\r\n            }else if(!this._pauseBgm&&v==0){\r\n                this._pauseBgm=true;\r\n                cc.audioEngine.pause(this.bgmAudioID);\r\n            }\r\n        }\r\n        if(this.bgmVolume != v){\r\n            cc.sys.localStorage.setItem(\"bgmVolume\",v);\r\n            this.bgmVolume = v;\r\n            cc.audioEngine.setVolume(this.bgmAudioID,v);\r\n        }\r\n    },\r\n\r\n    pauseAll:function(){\r\n        cc.audioEngine.pauseAll();\r\n    },\r\n    \r\n    resumeAll:function(){\r\n        cc.audioEngine.resumeAll();\r\n    }\r\n\r\n\r\n});\r\n"]}