{"version":3,"sources":["MJGameOver.js"],"names":["cc","Class","extends","Component","properties","_isGameEnd","_nodeGameOver","_nodeGameResult","_nodeSeats","_btnReady","_btnConfirm","_lblWin","_lblLose","_lblLiuju","_seats","onLoad","th","node","getChildByName","wanfa","getComponent","Label","string","socketIOManager","getWanfa","resustRoot","i","name","nodeSeat","push","viewData","username","winscore","losescore","reason","zhuang","headImg","Sprite","mahjongs","chipenggang","find","utils","addClickEvent","active","self","on","data","console","log","detail","onGameOver","length","myScore","seatIndex","score","seatView","userData","actionArr","isHu","huInfo","paixing","action","isDangDiao","isSanCaiShen","isCaiShenTou","isZiYiSe","isQingYiSe","isHunYiSe","seats","join","bankerIndex","headImgUrl","loader","load","url","type","err","texture","headSpriteFrame","SpriteFrame","Rect","width","height","spriteFrame","setScale","sortHolds","holds","k","childrenCount","mahjong","children","lackingNum","pengs","angangs","diangangs","bugangs","chis","pai","sprite","mahjongManager","getSpriteFrameByMJID","gold_icon","caishen","index","gangs","info","initChiPengGang","flag","nodeCPG","instantiate","pengPrefabSelf","addChild","x","sprites","getComponentsInChildren","mjid","getEmptySpriteFrame","idx","mjids","onBtnReadyClicked","sio","send","sort","a","b","aa","bb","update","dt"],"mappings":"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","file":"MJGameOver.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\scripts\\components","sourcesContent":["cc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        _isGameEnd:false,\r\n        _nodeGameOver:null,\r\n        _nodeGameResult:null,\r\n        _nodeSeats:[],\r\n        _btnReady:null,\r\n        _btnConfirm:null,\r\n        _lblWin:null,\r\n        _lblLose:null,\r\n        _lblLiuju:null,\r\n        _seats:[],\r\n    },\r\n\r\n    onLoad () {\r\n        if(th == null){\r\n            return;\r\n        }\r\n        this._nodeGameOver=this.node.getChildByName(\"game_over\");\r\n        this._nodeGameResult=this.node.getChildByName(\"game_result\");\r\n        this._lblWin = this._nodeGameOver.getChildByName(\"win\");\r\n        this._lblLose = this._nodeGameOver.getChildByName(\"lose\");\r\n        this._lblLiuju = this._nodeGameOver.getChildByName(\"liuju\");\r\n        var wanfa = this._nodeGameOver.getChildByName(\"wanfa\").getComponent(cc.Label);\r\n        wanfa.string = th.socketIOManager.getWanfa();\r\n\r\n        var resustRoot = this._nodeGameOver.getChildByName(\"result_list\");\r\n        for(var i=1;i<=4;i++){\r\n            var name=\"seat\"+i;\r\n            var nodeSeat = resustRoot.getChildByName(name);\r\n            this._nodeSeats.push(nodeSeat);\r\n            var viewData = {};\r\n            viewData.username=nodeSeat.getChildByName('username').getComponent(cc.Label);\r\n            viewData.winscore=nodeSeat.getChildByName('winscore').getComponent(cc.Label);\r\n            viewData.losescore=nodeSeat.getChildByName('losescore').getComponent(cc.Label);\r\n            viewData.reason=nodeSeat.getChildByName('reason').getComponent(cc.Label);\r\n            viewData.zhuang = nodeSeat.getChildByName('zhuang');\r\n            viewData.headImg= nodeSeat.getChildByName('head_clip').getChildByName('head_img').getComponent(cc.Sprite);\r\n            viewData.mahjongs = nodeSeat.getChildByName('pai');\r\n            viewData.chipenggang=nodeSeat.getChildByName(\"chipenggang\");\r\n            this._seats.push(viewData);\r\n        }\r\n\r\n        this._btnReady = cc.find(\"Canvas/game_over/btn_ready\");\r\n        if(this._btnReady){\r\n            th.utils.addClickEvent(this._btnReady ,this.node,\"MJGameOver\",\"onBtnReadyClicked\");\r\n        }\r\n        this._btnConfirm = cc.find(\"Canvas/game_over/btn_confirm\");\r\n        if(this._btnConfirm){\r\n            th.utils.addClickEvent(this._btnConfirm,this.node,\"MJGameOver\",\"onBtnReadyClicked\");\r\n        }\r\n        this._btnReady.active=true;\r\n        this._btnConfirm.active=false;\r\n        \r\n        \r\n\r\n        //初始化网络事件监听器\r\n        var self = this;\r\n        this.node.on('game_over',function(data){\r\n            console.log(\"==>MJGameOver game_over\",data.detail);\r\n            self.onGameOver(data.detail);\r\n        });\r\n\r\n        this.node.on('game_end',function(data){  \r\n            console.log(\"==>MJGameOver game_end\",data.detail);\r\n            self._isGameEnd = true;\r\n            self._btnReady.active=false;\r\n            self._btnConfirm.active=true;\r\n        });\r\n    },\r\n    onGameOver(data){\r\n        if(data.length == 0){\r\n            this._nodeGameResult.active = true;\r\n            return;\r\n        }\r\n        this._nodeGameOver.active = true;\r\n        this._lblWin.active = false;\r\n        this._lblLose.active = false;\r\n        this._lblLiuju.active = false;\r\n\r\n        var myScore=data[th.socketIOManager.seatIndex].score;\r\n        if(myScore > 0){\r\n            this._lblWin.active = true;\r\n        }else if(myScore < 0){\r\n            this._lblLose.active = true;\r\n        }else{\r\n            this._lblLiuju.active = true;\r\n        }\r\n        //显示玩家信息\r\n        for(var i=0;i<4;i++){\r\n            if(i>data.length-1){\r\n                this._nodeSeats[i].active=false;\r\n                continue;\r\n            }\r\n            this._nodeSeats[i].active=true;\r\n            var seatView = this._seats[i];\r\n            var userData = data[i];\r\n            var actionArr = [];\r\n\r\n            if(userData.isHu){\r\n                var huInfo=userData.huInfo;\r\n                var paixing=huInfo.paixing;\r\n                if(paixing==1){\r\n                    actionArr.push(\"正规七风13幺\");\r\n                }else if(paixing==2){\r\n                    actionArr.push(\"正规13幺\");\r\n                }else if(paixing==3){\r\n                    actionArr.push(\"非正规七风13幺\");\r\n                }else if(paixing==4){\r\n                    actionArr.push(\"非正规13幺\");\r\n                }else if(paixing==5){\r\n                    actionArr.push(\"7对\");\r\n                }else if(paixing==6){\r\n                    actionArr.push(\"碰碰胡\");\r\n                }else if(paixing==7){\r\n                    actionArr.push(\"平湖\");\r\n                }else if(paixing==8){\r\n                    actionArr.push(\"三财神\");\r\n                }\r\n\r\n                var action=huInfo.action;\r\n                if(action==1){\r\n                    actionArr.push(\"抢杠胡\");\r\n                }else if(action==2){\r\n                    actionArr.push(\"杠上花\");\r\n                }else if(action==3){\r\n                    actionArr.push(\"自摸\");\r\n                }\r\n\r\n                if(huInfo.isDangDiao){\r\n                    actionArr.push(\"单吊\");\r\n                }\r\n                if(huInfo.isSanCaiShen){\r\n                    actionArr.push(\"三财神\");\r\n                }\r\n                if(huInfo.isCaiShenTou){\r\n                    actionArr.push(\"财神头\");\r\n                }\r\n\r\n                if(huInfo.isZiYiSe){\r\n                    actionArr.push(\"字一色\");\r\n                }else if(huInfo.isQingYiSe){\r\n                    actionArr.push(\"清一色\");\r\n                }else if(huInfo.isHunYiSe){\r\n                    actionArr.push(\"混一色\");\r\n                }\r\n            }\r\n\r\n            seatView.username.string=th.socketIOManager.seats[i].name;\r\n            seatView.reason.string=actionArr.join(\"、\");\r\n            seatView.zhuang.active = th.socketIOManager.bankerIndex==i;\r\n            //seatView.headImg= nodeSeat.getChildByName('head_clip').getChildByName('head_img');\r\n            var headImgUrl=th.socketIOManager.seats[i].headImgUrl;\r\n            (function(seatView,headImgUrl){\r\n                cc.loader.load({url: headImgUrl, type: 'jpg'}, function (err, texture) {\r\n                    if(!err){\r\n                        var headSpriteFrame = new cc.SpriteFrame(texture, cc.Rect(0, 0, texture.width, texture.height));\r\n                        seatView.headImg.spriteFrame=headSpriteFrame;\r\n                        seatView.headImg.node.setScale(2-(texture.width/94));\r\n                    }\r\n                });\r\n            })(seatView,headImgUrl);\r\n            if(userData.score>=0){\r\n                seatView.winscore.string=\"+\"+userData.score;\r\n                seatView.winscore.node.active=true;\r\n                seatView.losescore.node.active=false;\r\n            }else{\r\n                seatView.losescore.string=userData.score;\r\n                seatView.losescore.node.active=true;\r\n                seatView.winscore.node.active=false;\r\n            }\r\n            this.sortHolds(userData.holds);\r\n            //隐藏所有牌\r\n            for(var k = 0; k < seatView.mahjongs.childrenCount; k++){\r\n                var mahjong = seatView.mahjongs.children[k];\r\n                mahjong.active = false;\r\n            }\r\n            var lackingNum = (userData.pengs.length + userData.angangs.length + userData.diangangs.length + userData.bugangs.length +userData.chis.length)*3;\r\n            //显示相关的牌\r\n            if(userData.isHu){\r\n                userData.holds.push(userData.huInfo.pai);\r\n            }\r\n            for(var k = 0; k < userData.holds.length; k++){\r\n                var pai = userData.holds[k];\r\n                var mahjong = seatView.mahjongs.children[k + lackingNum];\r\n                mahjong.active = true;\r\n                var sprite = mahjong.getComponent(cc.Sprite);\r\n                sprite.spriteFrame = th.mahjongManager.getSpriteFrameByMJID(\"M_\",pai);\r\n\r\n                var gold_icon=sprite.node.getChildByName(\"gold_icon\");\r\n                gold_icon.active=pai==th.socketIOManager.caishen;\r\n            }\r\n            //隐藏吃碰杠\r\n            for(var i=0;i<seatView.chipenggang.childrenCount;i++){\r\n                seatView.chipenggang.children[i].active=false;\r\n            }\r\n\r\n            //初始化杠牌\r\n            var index = 0;\r\n            var gangs = userData.angangs;\r\n            for(var k = 0; k < gangs.length; ++k){\r\n                var info = gangs[k];\r\n                this.initChiPengGang(seatView,index,info,\"angang\");\r\n                index++;    \r\n            }\r\n            var gangs = userData.diangangs;\r\n            for(var k = 0; k < gangs.length; ++k){\r\n                var info = gangs[k];\r\n                this.initChiPengGang(seatView,index,info,\"diangang\");\r\n                index++;    \r\n            }\r\n            var gangs = userData.bugangs;\r\n            for(var k = 0; k < gangs.length; ++k){\r\n                var info = gangs[k];\r\n                this.initChiPengGang(seatView,index,info,\"bugang\");\r\n                index++;    \r\n            }\r\n            //初始化碰牌\r\n            var pengs = userData.pengs\r\n            if(pengs){\r\n               for(var k = 0; k < pengs.length; ++k){\r\n                   var info = pengs[k];\r\n                   this.initChiPengGang(seatView,index,info,\"peng\");\r\n                   index++;    \r\n               }    \r\n            }\r\n            //初始化吃牌\r\n            var chis = userData.chis\r\n            if(chis){\r\n               for(var k = 0; k < chis.length; ++k){\r\n                   var info = chis[k];\r\n                   this.initChiPengGang(seatView,index,info,\"chi\");\r\n                   index++;    \r\n               }    \r\n            }\r\n        }\r\n \r\n    },\r\n    initChiPengGang:function(seatView,index,info,flag){\r\n        var nodeCPG = null;\r\n        if(seatView.chipenggang.childrenCount <= index){\r\n            nodeCPG = cc.instantiate(th.mahjongManager.pengPrefabSelf);\r\n            seatView.chipenggang.addChild(nodeCPG)\r\n        }else{\r\n            nodeCPG = seatView.chipenggang.children[index];\r\n            nodeCPG.active = true;\r\n        }\r\n        nodeCPG.active = true;\r\n        nodeCPG.x = index * 55 * 3 + index * 10;\r\n        var sprites = nodeCPG.getComponentsInChildren(cc.Sprite);\r\n        if(flag==\"angang\"){\r\n            for(var i = 0; i < sprites.length; i++){\r\n                var sprite = sprites[i];\r\n                if(sprite.node.name == \"point_left\" || sprite.node.name == \"point_dui\" || sprite.node.name == \"point_right\"){\r\n                    sprite.node.active = false;\r\n                }else{\r\n                    if(sprite.node.name==\"gang\"){\r\n                        sprite.node.active = true;\r\n                        sprite.spriteFrame = th.mahjongManager.getSpriteFrameByMJID(\"B_\",info.mjid);\r\n                    }else{\r\n                        sprite.node.active = true;\r\n                        sprite.spriteFrame = th.mahjongManager.getEmptySpriteFrame(\"myself\");\r\n                    }\r\n                }\r\n            }\r\n        }else if(flag==\"diangang\"||flag==\"bugang\"){\r\n            for(var i = 0; i < sprites.length; i++){\r\n                var sprite = sprites[i];\r\n                if(sprite.node.name == \"point_left\" || sprite.node.name == \"point_dui\" || sprite.node.name == \"point_right\"){\r\n                    sprite.node.active = false;\r\n                }else{\r\n                    sprite.node.active = true;\r\n                    sprite.spriteFrame = th.mahjongManager.getSpriteFrameByMJID(\"B_\",info.mjid);\r\n                }\r\n            }\r\n        }else if(flag==\"peng\"){\r\n            for(var i = 0; i < sprites.length; i++){\r\n                var sprite = sprites[i];\r\n                if(sprite.node.name == \"point_left\" || sprite.node.name == \"point_dui\" || sprite.node.name == \"point_right\"){\r\n                    sprite.node.active = false;\r\n                }else{\r\n                    if(sprite.node.name == \"gang\"){\r\n                        sprite.node.active = false;\r\n                    }else{\r\n                        sprite.node.active = true;\r\n                        sprite.spriteFrame = th.mahjongManager.getSpriteFrameByMJID(\"B_\",info.mjid);\r\n                    }\r\n                }\r\n            }\r\n            \r\n        }else if(flag==\"chi\"){\r\n            var idx=0;\r\n            for(var i = 0; i < sprites.length; i++){\r\n                var sprite = sprites[i];\r\n                if(sprite.node.name == \"point_left\" || sprite.node.name == \"point_dui\" || sprite.node.name == \"point_right\"){\r\n                    sprite.node.active = false;\r\n                }else{\r\n                    if(sprite.node.name == \"gang\"){\r\n                        sprite.node.active = false;\r\n                    }else{\r\n                        sprite.node.active = true;\r\n                        sprite.spriteFrame = th.mahjongManager.getSpriteFrameByMJID(\"B_\",info.mjids[idx]);\r\n                        idx+=1;\r\n                    }\r\n                }\r\n               \r\n            }\r\n        }\r\n    },\r\n    onBtnReadyClicked:function(){\r\n        console.log(\"onBtnReadyClicked\");\r\n        if(this._isGameEnd){\r\n            this._nodeGameResult.active=true;\r\n        }else{\r\n            th.sio.send(\"ready\"); \r\n        }\r\n        this._nodeGameOver.active=false;\r\n    },\r\n    sortHolds:function(holds){\r\n        if(holds==null){\r\n            return holds;\r\n        }\r\n        holds.sort(function(a,b){\r\n            var aa=a;\r\n            var bb=b;\r\n            if(aa==th.socketIOManager.caishen){\r\n                aa=aa-100;\r\n            }\r\n            if(bb==th.socketIOManager.caishen){\r\n                bb=bb-100;\r\n            }\r\n            return aa-bb;\r\n        });\r\n        return holds;\r\n    },\r\n    update (dt) {\r\n    },\r\n});\r\n"]}