{"version":3,"sources":["..\\..\\..\\..\\..\\assets\\scripts\\components/assets\\scripts\\components\\MJChiPengGangs.js"],"names":["cc","Class","extends","Component","properties","onLoad","th","self","myself","node","getChildByName","nodeChiPengGang","realwidth","director","getVisibleSize","width","scale","scaleX","scaleY","on","data","console","log","detail","onChiPengGangChanged","onGameBegin","seats","socketIOManager","i","hideSide","side","nodeSide","childrenCount","children","active","seatData","pengs","angangs","diangangs","bugangs","chis","localIndex","getLocalIndex","index","mahjongManager","getSide","pre","getFoldPre","gangs","length","info","initChiPengAndGangs","flag","seatIndex","nodeCPG","instantiate","pengPrefabLeft","pengPrefabSelf","addChild","y","setLocalZOrder","x","sprites","getComponentsInChildren","Sprite","sprite","name","spriteFrame","getEmptySpriteFrame","isUp","isNext","isDui","getUpSeatIndex","idx","getNextSeatIndex","getSpriteFrameByMJID","mjid","mjids","total","ret","getDuiSeatIndex"],"mappings":"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","file":"MJChiPengGangs.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\scripts\\components","sourcesContent":["cc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n       \r\n    },\r\n\r\n    onLoad: function () {\r\n        if(th==null){\r\n            return;\r\n        }\r\n        var self = this;\r\n        var myself = this.node.getChildByName(\"myself\");\r\n        var nodeChiPengGang = myself.getChildByName(\"ChiPengGang\");\r\n        var realwidth = cc.director.getVisibleSize().width;\r\n        var scale = realwidth / 1280;\r\n        nodeChiPengGang.scaleX *= scale;\r\n        nodeChiPengGang.scaleY *= scale;\r\n\r\n        this.node.on('chi_notify_push',function(data){\r\n            console.log(\"==>ChiPengGang chi_notify_push\",data.detail);\r\n            var data = data.detail;\r\n            self.onChiPengGangChanged(data);\r\n        });\r\n\r\n        this.node.on('peng_notify_push',function(data){\r\n            console.log(\"==>ChiPengGang peng_notify_push\",data.detail);\r\n            var data = data.detail;\r\n            self.onChiPengGangChanged(data);\r\n        });\r\n        \r\n        this.node.on('gang_notify_push',function(data){\r\n            console.log(\"==>ChiPengGang gang_notify_push\",data.detail);\r\n            self.onChiPengGangChanged(data.detail);\r\n        });\r\n\r\n        this.node.on('begin_push',function(data){\r\n            self.onGameBegin();\r\n        });\r\n\r\n        this.node.on('clean_push',function(){\r\n            self.onGameBegin();\r\n        });\r\n\r\n        var seats = th.socketIOManager.seats;\r\n        for(var i in seats){\r\n            this.onChiPengGangChanged(seats[i]);\r\n        }\r\n    },\r\n    onGameBegin:function(){\r\n        this.hideSide(\"myself\");\r\n        this.hideSide(\"right\");\r\n        this.hideSide(\"up\");\r\n        this.hideSide(\"left\");\r\n    },\r\n    hideSide:function(side){\r\n        var nodeSide = this.node.getChildByName(side);\r\n        var nodeChiPengGang = nodeSide.getChildByName(\"ChiPengGang\");\r\n        if(nodeChiPengGang){\r\n            for(var i = 0; i < nodeChiPengGang.childrenCount; ++i){\r\n                nodeChiPengGang.children[i].active = false;\r\n            }            \r\n        }\r\n    },\r\n    onChiPengGangChanged:function(seatData){\r\n        if(seatData.pengs == null && seatData.angangs == null && seatData.diangangs == null && seatData.bugangs == null && seatData.chis == null){\r\n            return;\r\n        }\r\n        var localIndex = th.socketIOManager.getLocalIndex(seatData.index);\r\n        var side = th.mahjongManager.getSide(localIndex);\r\n        var pre = th.mahjongManager.getFoldPre(localIndex);\r\n        var nodeSide = this.node.getChildByName(side);\r\n        var nodeChiPengGang = nodeSide.getChildByName(\"ChiPengGang\");\r\n        for(var i = 0; i < nodeChiPengGang.childrenCount; ++i){\r\n            nodeChiPengGang.children[i].active = false;\r\n        }\r\n        //初始化杠牌\r\n        var index = 0;\r\n        var gangs = seatData.angangs;\r\n        for(var i = 0; i < gangs.length; ++i){\r\n            var info = gangs[i];\r\n            this.initChiPengAndGangs(nodeChiPengGang,side,pre,index,info,\"angang\",seatData.index);\r\n            index++;    \r\n        } \r\n        gangs = seatData.diangangs;\r\n        for(var i = 0; i < gangs.length; ++i){\r\n            var info = gangs[i];\r\n            this.initChiPengAndGangs(nodeChiPengGang,side,pre,index,info,\"diangang\",seatData.index);\r\n            index++;    \r\n        }\r\n        gangs = seatData.bugangs;\r\n        for(var i = 0; i < gangs.length; ++i){\r\n            var info = gangs[i];\r\n            this.initChiPengAndGangs(nodeChiPengGang,side,pre,index,info,\"bugang\",seatData.index);\r\n            index++;    \r\n        }\r\n        //初始化碰牌\r\n        var pengs = seatData.pengs\r\n        if(pengs){\r\n            for(var i = 0; i < pengs.length; ++i){\r\n                var info = pengs[i];\r\n                this.initChiPengAndGangs(nodeChiPengGang,side,pre,index,info,\"peng\",seatData.index);\r\n                index++;    \r\n            }    \r\n        }  \r\n        //初始化吃的牌\r\n        var chis = seatData.chis\r\n        if(chis){\r\n            for(var i = 0; i < chis.length; ++i){\r\n                var info = chis[i];\r\n                this.initChiPengAndGangs(nodeChiPengGang,side,pre,index,info,\"chi\",seatData.index);\r\n                index++;    \r\n            }    \r\n        }\r\n    },\r\n    initChiPengAndGangs:function(nodeChiPengGang,side,pre,index,info,flag,seatIndex){\r\n        console.log(\"initChiPengAndGangs\",side,pre,index,info,flag);\r\n        var nodeCPG = null;\r\n        if(nodeChiPengGang.childrenCount <= index){\r\n            if(side == \"left\" || side == \"right\"){\r\n                nodeCPG = cc.instantiate(th.mahjongManager.pengPrefabLeft);\r\n            }else{\r\n                nodeCPG = cc.instantiate(th.mahjongManager.pengPrefabSelf);\r\n            }\r\n            nodeChiPengGang.addChild(nodeCPG);\r\n        }else{\r\n            nodeCPG = nodeChiPengGang.children[index];\r\n            nodeCPG.active = true;\r\n        }\r\n        if(side == \"left\"){\r\n            nodeCPG.y = -(index * 25 * 3);                    \r\n        }else if(side == \"right\"){\r\n            nodeCPG.y = (index * 25 * 3);\r\n            nodeCPG.setLocalZOrder(-index);\r\n        }else if(side == \"myself\"){\r\n            nodeCPG.x = index * 55 * 3 + index * 10;                    \r\n        }else{\r\n            nodeCPG.x = -(index * 55*3) - index * 7;\r\n        }\r\n\r\n        var sprites = nodeCPG.getComponentsInChildren(cc.Sprite);\r\n        if(flag==\"angang\"){\r\n            for(var i = 0; i < sprites.length; i++){\r\n                var sprite = sprites[i];\r\n                if(sprite.node.name == \"point_left\" || sprite.node.name == \"point_dui\" || sprite.node.name == \"point_right\"){\r\n                    sprite.node.active = false;\r\n                    continue;\r\n                }\r\n                sprite.node.active = true;\r\n                sprite.spriteFrame = th.mahjongManager.getEmptySpriteFrame(side);\r\n            }\r\n        }else if(flag==\"diangang\"||flag==\"bugang\"){\r\n            var isUp=false;\r\n            var isNext=false;\r\n            var isDui=false;\r\n            if(this.getUpSeatIndex(seatIndex)==info.idx){\r\n                isUp=true;\r\n                isNext=false;\r\n                isDui=false;\r\n            }else if(this.getNextSeatIndex(seatIndex)==info.idx){\r\n                isUp=false;\r\n                isNext=true;\r\n                isDui=false;\r\n            }else{\r\n                isUp=false;\r\n                isNext=false;\r\n                isDui=true;\r\n            }\r\n            for(var i = 0; i < sprites.length; i++){\r\n                var sprite = sprites[i];\r\n                if(sprite.node.name == \"point_left\" || sprite.node.name == \"point_right\" || sprite.node.name == \"point_dui\"){\r\n                    if(sprite.node.name == \"point_left\" ){\r\n                        sprite.node.active= isUp;\r\n                    }else if(sprite.node.name == \"point_right\"){\r\n                        sprite.node.active= isNext;\r\n                    }else if(sprite.node.name == \"point_dui\"){\r\n                        sprite.node.active= isDui;\r\n                    }\r\n                    if(side==\"up\"){\r\n                        sprite.node.y = -53;\r\n                    }else if(side==\"right\"){\r\n                        sprite.node.x = -40;\r\n                    }\r\n                    continue;\r\n                }\r\n                sprite.node.active = true;\r\n                sprite.spriteFrame = th.mahjongManager.getSpriteFrameByMJID(pre,info.mjid);  \r\n            }\r\n        }else if(flag==\"peng\"){\r\n            var isUp=false;\r\n            var isNext=false;\r\n            var isDui=false;\r\n            if(this.getUpSeatIndex(seatIndex)==info.idx){\r\n                isUp=true;\r\n                isNext=false;\r\n                isDui=false;\r\n            }else if(this.getNextSeatIndex(seatIndex)==info.idx){\r\n                isUp=false;\r\n                isNext=true;\r\n                isDui=false;\r\n            }else{\r\n                isUp=false;\r\n                isNext=false;\r\n                isDui=true;\r\n            }\r\n            for(var i = 0; i < sprites.length; i++){\r\n                var sprite = sprites[i];\r\n                if(sprite.node.name == \"point_left\" || sprite.node.name == \"point_right\" || sprite.node.name == \"point_dui\"){\r\n                    if(sprite.node.name == \"point_left\" ){\r\n                        sprite.node.active= isUp;\r\n                    }else if(sprite.node.name == \"point_right\"){\r\n                        sprite.node.active= isNext;\r\n                    }else if(sprite.node.name == \"point_dui\"){\r\n                        sprite.node.active= isDui;\r\n                    }\r\n                    if(side==\"up\"){\r\n                        sprite.node.y = -53;\r\n                    }else if(side==\"right\"){\r\n                        sprite.node.x = -40;\r\n                    }\r\n                    continue;\r\n                }\r\n                if(sprite.node.name == \"gang\"){\r\n                    sprite.node.active = false;\r\n                }else{\r\n                    sprite.node.active = true;\r\n                    sprite.spriteFrame = th.mahjongManager.getSpriteFrameByMJID(pre,info.mjid);    \r\n                }\r\n            }\r\n        }else if(flag==\"chi\"){\r\n            var isUp=false;\r\n            var isNext=false;\r\n            var isDui=false;\r\n            if(this.getUpSeatIndex(seatIndex)==info.idx){\r\n                isUp=true;\r\n                isNext=false;\r\n                isDui=false;\r\n            }else if(this.getNextSeatIndex(seatIndex)==info.idx){\r\n                isUp=false;\r\n                isNext=true;\r\n                isDui=false;\r\n            }else{\r\n                isUp=false;\r\n                isNext=false;\r\n                isDui=true;\r\n            }\r\n\r\n            var idx=0;\r\n            for(var i = 0; i < sprites.length; i++){\r\n                var sprite = sprites[i];\r\n                if(sprite.node.name == \"point_left\" || sprite.node.name == \"point_right\" || sprite.node.name == \"point_dui\"){\r\n                    if(sprite.node.name == \"point_left\" ){\r\n                        sprite.node.active= isUp;\r\n                    }else if(sprite.node.name == \"point_right\"){\r\n                        sprite.node.active= isNext;\r\n                    }else if(sprite.node.name == \"point_dui\"){\r\n                        sprite.node.active= isDui;\r\n                    }\r\n                    if(side==\"up\"){\r\n                        sprite.node.y = -53;\r\n                    }else if(side==\"right\"){\r\n                        sprite.node.x = -40;\r\n                    }\r\n                    continue;\r\n                }\r\n                if(sprite.node.name == \"gang\"){\r\n                    sprite.node.active = false;\r\n                }else{\r\n                    sprite.node.active = true;\r\n                    sprite.spriteFrame = th.mahjongManager.getSpriteFrameByMJID(pre,info.mjids[idx]);    \r\n                    idx+=1;\r\n                }\r\n            }\r\n        }\r\n    },\r\n\r\n    getUpSeatIndex:function(seatIndex){\r\n        var total=th.socketIOManager.seats.length;\r\n        var ret = (seatIndex - 1+ total) % total;\r\n        return ret;\r\n    },\r\n    getNextSeatIndex:function(seatIndex){\r\n        var total=th.socketIOManager.seats.length;\r\n        var ret = (seatIndex +1 + total) % total;\r\n        return ret;\r\n    },\r\n    getDuiSeatIndex:function(seatIndex){\r\n        var total=th.socketIOManager.seats.length;\r\n        var ret = (seatIndex + 2 + total) % total;\r\n        return ret;\r\n    }\r\n    // update: function (dt) {\r\n\r\n    // },\r\n    \r\n});\r\n"]}