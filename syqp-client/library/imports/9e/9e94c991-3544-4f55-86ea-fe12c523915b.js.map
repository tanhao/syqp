{"version":3,"sources":["..\\..\\..\\..\\..\\assets\\scripts\\components/assets\\scripts\\components\\MJRoom.js"],"names":["cc","Class","extends","Component","properties","lblRoomId","Label","lblWangfa","_seats","onLoad","th","initView","initSeats","initEventHandlers","string","socketIOManager","roomId","getWanfa","seatNames","i","length","seats","seatComponent","node","getChildByName","getComponent","push","initSingleSeat","seat","index","getLocalIndex","setInfo","userId","name","score","headImgUrl","setFangzhu","creator","setBank","seatindex","bankIndex","setReady","ready","setOffline","online","onMenuClicked","menuWin","active","onBtnDissolveRequestClicked","alert","show","sio","send","onBtnDissolveClicked","onBtnLeaveClicked","isFangzhu","onBtnSettingClicked","settingWin","onBtnChatClicked","_seat","setCountdown","log","onBtnVoiceClicked","onBtnReadyClicked"],"mappings":"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","file":"MJRoom.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\scripts\\components","sourcesContent":["cc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        lblRoomId:cc.Label,\r\n        lblWangfa:cc.Label,\r\n        _seats:[]\r\n    },\r\n\r\n    onLoad: function () {\r\n        if(th==null){ return; }\r\n        this.initView();\r\n        this.initSeats();\r\n        this.initEventHandlers();\r\n    },\r\n\r\n    initView:function(){\r\n        this.lblRoomId.string=th.socketIOManager.roomId || '------';\r\n        this.lblWangfa.string=th.socketIOManager.getWanfa();\r\n\r\n        var seatNames = [\"myself\",\"right\",\"up\",\"left\"];\r\n        for(var i=0;i<seatNames.length;i++){\r\n            if((i==2&&th.socketIOManager.seats.length==3)||((i==1||i==3)&&th.socketIOManager.seats.length==2)){\r\n                continue;\r\n            }\r\n            var seatComponent=this.node.getChildByName(seatNames[i]).getChildByName('Seat').getComponent('MJSeat');\r\n            this._seats.push(seatComponent);\r\n        }\r\n\r\n    },\r\n\r\n  \r\n    initSeats:function(){\r\n        var seats=th.socketIOManager.seats;\r\n        for(var i = 0; i < seats.length; ++i){\r\n            this.initSingleSeat(seats[i]);\r\n        }\r\n    },\r\n\r\n    initSingleSeat:function(seat){\r\n        var index = th.socketIOManager.getLocalIndex(seat.index);\r\n        this._seats[index].setInfo(seat.userId,seat.name,seat.score,seat.headImgUrl);\r\n        this._seats[index].setFangzhu(seat.userId==th.socketIOManager.creator);\r\n        this._seats[index].setBank(seat.seatindex==th.socketIOManager.bankIndex);\r\n        this._seats[index].setReady(seat.ready);\r\n        this._seats[index].setOffline(!seat.online);\r\n    },\r\n\r\n    initEventHandlers:function(){\r\n\r\n    },\r\n\r\n    onMenuClicked:function(){\r\n        this.menuWin.active=!this.menuWin.active;\r\n    },\r\n    onBtnDissolveRequestClicked:function(){\r\n        this.menuWin.active=false;\r\n        th.alert.show(\"申请解散房间\",\"申请解散房间不会退换钻石，是否确定申请解散？\",function(){\r\n            th.sio.send(\"dissolve_request\"); \r\n        },true)\r\n    },\r\n    onBtnDissolveClicked:function(){\r\n        this.menuWin.active=false;\r\n        th.alert.show(\"解散房间\",\"解散房间不扣钻石，是否确定解散？\",function(){\r\n            th.sio.send(\"dissolve\"); \r\n        },true)\r\n    },\r\n    onBtnLeaveClicked:function(){\r\n        this.menuWin.active=false;\r\n        if(th.socketIOManager.isFangzhu()){\r\n            th.alert.show(\"离开房间\",\"您是房主，不能离开房间。\",function(){\r\n                //th.sio.send(\"leave\"); \r\n            })\r\n            return ;\r\n        }\r\n        th.alert.show(\"离开房间\",\"您确定要离开房间?\",function(){\r\n            th.sio.send(\"leave\"); \r\n        },true)\r\n    },\r\n    onBtnSettingClicked:function(){\r\n        this.menuWin.active=false;\r\n        this.settingWin.active=true;\r\n    },\r\n    onBtnChatClicked:function(){\r\n        this._seat[0].setCountdown(10);\r\n        cc.log('onChatClicked==>');\r\n    },\r\n    onBtnVoiceClicked:function(){\r\n        cc.log('onVoiceClicked==>');\r\n    },\r\n    onBtnReadyClicked:function(){\r\n        cc.log('onBtnReadyClicked==>');\r\n        th.sio.send(\"ready\"); \r\n    },\r\n\r\n\r\n    // update: function (dt) {\r\n\r\n    // },\r\n    \r\n    \r\n\r\n});\r\n"]}