{"version":3,"sources":["..\\..\\..\\..\\..\\assets\\scripts\\components/assets\\scripts\\components\\MJGame.js"],"names":["cc","Class","extends","Component","properties","lblMjCount","Label","lblRoundCount","spriteCaishen","Sprite","btnReady","Button","btnGang","btnPeng","btnChi","btnHu","btnGuo","chupaidian","settingWin","Node","optionsWin","nodePrepare","nodeGameInfo","nodeCaishen","_mymjs","_effects","_chupais","onLoad","th","addComponent","initView","initEventHandlers","active","onGameBegin","audioManager","playBGM","holds","node","getChildByName","j","children","length","sprite","getComponent","push","spriteFrame","seatNames","i","mjs","socketIOManager","seats","seatNode","animation","Animation","hideOptions","self","dataEventHandler","on","target","console","log","JSON","stringify","detail","seat","round","ready","initMahjongs","string","mjsy","config","data","hideChupai","showAction","showChupai","pai","chupai","localIndex","getLocalIndex","turn","mahjongManager","getSpriteFrameByMJID","hu","gang","peng","chi","_options","gangpai","gp","addOption","seatIndex","sort","a","b","pokerId","_myHoldPokers","getSpriteFrameByPokerId","_seat","setRestCard","activeReadyBtn","isReady","userManager","userId"],"mappings":"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","file":"MJGame.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\scripts\\components","sourcesContent":["cc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        lblMjCount:cc.Label,\r\n        lblRoundCount:cc.Label,\r\n        spriteCaishen:cc.Sprite,\r\n        btnReady:cc.Button,\r\n        btnGang:cc.Button,\r\n        btnPeng:cc.Button,\r\n        btnChi:cc.Button,\r\n        btnHu:cc.Button,\r\n        btnGuo:cc.Button,\r\n        chupaidian:cc.Sprite,\r\n        settingWin:cc.Node,\r\n        optionsWin:cc.Node,    ///所有可以做的操作节点\r\n        nodePrepare:cc.Node,\r\n        nodeGameInfo:cc.Node,\r\n        nodeCaishen:cc.Node,\r\n\r\n        _mymjs:[],   //自己手上的牌Sprite结合\r\n        _effects:[], //每个座位动画节点（Animation）\r\n        _chupais:[], //每个座位出牌节点（Sprite）\r\n    },\r\n\r\n    onLoad () {\r\n        if(th==null){ return; }\r\n        this.addComponent(\"MJFolds\");\r\n        this.initView();\r\n        this.initEventHandlers();\r\n\r\n        this.nodePrepare.active=true;\r\n        this.nodeCaishen.active=false;\r\n        this.nodeGameInfo.active=false;\r\n\r\n        this.onGameBegin();\r\n        th.audioManager.playBGM(\"bg_fight.mp3\");\r\n    },\r\n\r\n    initView:function(){\r\n        //把自己的牌都设置为null\r\n        var holds = this.node.getChildByName('myself').getChildByName('Holds');\r\n        for(var j=0;j<holds.children.length;j++){\r\n                var sprite = holds.children[j].getComponent(cc.Sprite);\r\n                sprite.node.active=false;\r\n                this._mymjs.push(sprite);\r\n                sprite.spriteFrame = null;\r\n        }\r\n        \r\n        var seatNames = [\"myself\",\"right\",\"up\",\"left\"];\r\n        //隐藏其他玩家手上的牌\r\n        for(var i=1;i<seatNames.length;i++){\r\n            var mjs=this.node.getChildByName(seatNames[i]).getChildByName('Holds').children;\r\n            for(var j=0;j<mjs.length;j++){\r\n                var sprite = mjs[j].getComponent(cc.Sprite);\r\n                sprite.node.active=false;\r\n            }\r\n        }\r\n        for(var i=0;i<seatNames.length;i++){\r\n            if((i==2&&th.socketIOManager.seats.length==3)||((i==1||i==3)&&th.socketIOManager.seats.length==2)){\r\n                continue;\r\n            }\r\n            var seatNode=this.node.getChildByName(seatNames[i]);\r\n            var animation=seatNode.getChildByName('Effect').getComponent(cc.Animation);\r\n            this._effects.push(animation);\r\n            \r\n        }\r\n        for(var i=0;i<seatNames.length;i++){\r\n            var seatNode=this.node.getChildByName(seatNames[i]);\r\n            var sprite=seatNode.getChildByName('Chupai').getComponent(cc.Sprite);\r\n            sprite.node.active=false;\r\n            sprite.spriteFrame = null;\r\n            this._chupais.push(sprite);\r\n        }\r\n        this.hideOptions();\r\n    },\r\n\r\n    initEventHandlers:function(){\r\n        var self=this;\r\n        th.socketIOManager.dataEventHandler=this.node;\r\n        \r\n        //检查IP\r\n        this.node.on('check_ip', function (target) {\r\n            console.log('==>MJGame check_ip:',JSON.stringify(target.detail));\r\n        });\r\n        //自己准备返回\r\n        this.node.on(\"ready_result\",function(target){\r\n            console.log('==>Gmae ready_result:',JSON.stringify(target.detail));\r\n            var seat=target.detail;\r\n            self.btnReady.node.active = th.socketIOManager.round==0&&!seat.ready;\r\n        })\r\n\r\n        //玩家手上的牌\r\n        this.node.on(\"holds_push\",function(target){\r\n            console.log('==>Gmae holds_push:',JSON.stringify(target.detail));\r\n            self.initMahjongs();\r\n        })\r\n        //开始游戏，出头的人\r\n        this.node.on(\"begin_push\",function(target){\r\n            console.log('==>Gmae begin_push:',JSON.stringify(target.detail));\r\n            self.onGameBegin();\r\n             //第一把开局，要检查IP\r\n            if(th.socketIOManager.round == 1){\r\n                cc.log(\"check ip ....\");    \r\n            }\r\n        })\r\n        //断线\r\n        this.node.on('disconnect', function (target) {\r\n            console.log('==>Gmae disconnect:',JSON.stringify(target.detail));\r\n        });\r\n        \r\n        //通知还剩多少张牌\r\n         this.node.on(\"mjsy_push\",function(target){\r\n            console.log('==>Gmae mjsy_push:',JSON.stringify(target.detail));\r\n            self.lblMjCount.string=\"剩余 \"+th.socketIOManager.mjsy+\" 张\";\r\n        })\r\n\r\n        //通知当前是第几局\r\n        this.node.on(\"round_push\",function(target){\r\n            console.log('==>Gmae round_push:',JSON.stringify(target.detail));\r\n            self.lblRoundCount.string=\"剩余 \"+(th.socketIOManager.config.round-th.socketIOManager.round)+\" 局\";\r\n        })\r\n\r\n\r\n        this.node.on('begin_push',function(data){\r\n            console.log('==>Gmae begin_push:',JSON.stringify(target.detail));\r\n            self.onGameBegin();\r\n            cc.log(\"check ip ....\");    \r\n        });\r\n        \r\n        this.node.on('chupai_push',function(data){\r\n            console.log('==>Gmae chupai_push:',JSON.stringify(target.detail));\r\n            self.hideChupai();\r\n        });\r\n\r\n        this.node.on('action_push',function(data){\r\n            console.log('==>Gmae action_push:',JSON.stringify(target.detail));\r\n            self.showAction(data.detail);\r\n        });\r\n\r\n    },\r\n    onGameBegin:function(){\r\n        /*\r\n        this.hideOptions();\r\n        //显示手上的牌\r\n        var seatNames = [\"right\",\"up\",\"left\"];\r\n        for(var i=0;i<seatNames.length;i++){\r\n            var mjs=this.node.getChildByName(seatNames[i]).getChildByName('Holds').children;\r\n            for(var j=0;j<mjs.length;j++){\r\n                var mj=mjs[j];\r\n                mj.active=false;\r\n                var sprite = mj.getComponent(cc.Sprite);\r\n                sprite.spriteFFrame = null;\r\n                this._folds[name].push(sprite);  \r\n            }\r\n        }\r\n        */\r\n    },\r\n    hideChupai:function(){\r\n        for(var i = 0; i < this._chupais.length;i++){\r\n            this._chupais[i].node.active = false;\r\n        }     \r\n    },\r\n    showChupai:function(){\r\n        var pai = th.socketIOManager.chupai; \r\n        if( pai !=chupai){\r\n            var localIndex = this.getLocalIndex(th.socketIOManager.turn);\r\n            var sprite = this._chupais[localIndex];\r\n            sprite.spriteFrame = th.mahjongManager.getSpriteFrameByMJID(\"M_\",pai);\r\n            sprite.node.active = true;   \r\n        }\r\n    },\r\n    showAction:function(data){\r\n        if(this.optionsWin.active){\r\n            this.hideOptions();\r\n        }\r\n        if(data && (data.hu || data.gang || data.peng || data.chi)){\r\n            this._options.active = true;\r\n            if(data.hu){\r\n                this.btnHu.node.active=true;\r\n            }\r\n            if(data.peng){\r\n                this.btnChi.node.active=true;\r\n            }\r\n            if(data.chi){\r\n                this.btnHu.node.active=true;\r\n            }\r\n            if(data.gang){\r\n                for(var i = 0; i < data.gangpai.length;++i){\r\n                    var gp = data.gangpai[i];\r\n                    this.addOption(\"btnGang\",gp);\r\n                }\r\n            }   \r\n        }\r\n    },\r\n    initMahjongs:function(){\r\n        var seats=th.socketIOManager.seats;\r\n        var seat=seats[th.socketIOManager.seatIndex];\r\n        var holds=seat.holds;\r\n        cc.log(\"initPokers:\",holds);\r\n        //排序\r\n        holds.sort(function(a,b){return a-b});\r\n        for(var i=0;i<holds.length;i++){\r\n            var pokerId=holds[i];\r\n            var sprite=this._myHoldPokers[i];\r\n            sprite.node.pokerId = pokerId;\r\n            sprite.spriteFrame = th.mahjongManager.getSpriteFrameByPokerId(pokerId);\r\n            sprite.node.active = true;\r\n        }\r\n        for(var i=0;i<seats.length;i++){\r\n            this._seat[i].setRestCard(holds.length);\r\n        }\r\n    },\r\n    \r\n    /*\r\n    update (dt) {\r\n    },\r\n    */\r\n\r\n    hideOptions:function(data){\r\n        this.optionsWin.active=false;\r\n        var activeReadyBtn=th.socketIOManager.round==0&&!th.socketIOManager.isReady(th.userManager.userId)\r\n        this.btnReady.node.active = activeReadyBtn;\r\n        this.btnGang.node.active=false;\r\n        this.btnPeng.node.active=false;\r\n        this.btnChi.node.active=false;\r\n        this.btnHu.node.active=false;\r\n        this.btnGuo.node.active=false;\r\n    },\r\n  \r\n\r\n});\r\n"]}